{% load static %}
{% load auth_extras %}

<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}Junta UT{% endblock %}</title>

  <link rel="stylesheet" href="{% static 'css/main.css' %}">
  <link rel="stylesheet" href="{% static 'css/components.css' %}">
  <link rel="stylesheet" href="{% static 'css/utilities.css' %}">
  {% block extra_head %}{% endblock %}
</head>
<body>

  <header class="site-header">
    <nav class="navbar container">
      <a class="brand" href="{% url 'core:home' %}">
        <img src="{% static 'img/logo.png' %}" alt="Logo Junta UT">
        <span>Junta UT</span>
      </a>

      <ul class="nav-links">
        <!-- Comunes a todo usuario autenticado -->
        {% if request.user.is_authenticated %}
          <li><a href="{% url 'core:announcement_list' %}">Avisos</a></li>
          <li><a href="{% url 'core:meeting_list' %}">Reuniones</a></li>

          {# Bloque Admin/Secretario/Superusuario (sin paréntesis) #}
          {% if request.user.is_superuser or request.user|has_group:'Admin' or request.user|has_group:'Secretario' %}
            <li><a href="{% url 'core:dashboard' %}">Panel</a></li>
            <li><a href="{% url 'core:minutes_create' %}">Nueva Acta</a></li>
            <li><a href="{% url 'core:fee_list' %}">Cuotas</a></li>
            <li><a href="{% url 'core:payment_list_admin' %}">Pagos</a></li>
          {% else %}
            {# Vecino: solo su listado de pagos #}
            <li><a href="{% url 'core:my_payments' %}">Mis pagos</a></li>
          {% endif %}
        {% endif %}
      </ul>

      <div class="nav-actions">
        {% if request.user.is_authenticated %}
          <form action="{% url 'logout' %}" method="post" style="display:inline;">
            {% csrf_token %}
            <button type="submit" class="btn btn-outline">Cerrar sesión</button>
          </form>
        {% else %}
          <a class="btn btn-primary" href="{% url 'login' %}">Iniciar sesión</a>
        {% endif %}
      </div>
    </nav>
  </header>

  <main class="site-content container">
    {% block content %}{% endblock %}
  </main>

  <footer class="site-footer">
    <p>© {{ now|date:"Y" }} Junta de Vecinos UT</p>
  </footer>
</body>
</html>
