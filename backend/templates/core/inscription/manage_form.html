{% extends "base.html" %}

{% block title %}Gestionar inscripción #{{ object.id }} – Junta UT{% endblock %}

{% block content %}
<section class="insc-manage-wrapper">
  <div class="card insc-manage-card">
    <header class="insc-manage-header">
      <h1 class="insc-manage-title">
        Gestionar inscripción #{{ object.id }}
      </h1>
      <p class="insc-manage-subtitle">
        Revisa el archivo enviado, define el estado de la solicitud y asigna el rol
        correspondiente a la persona que se está inscribiendo en la Junta.
      </p>
    </header>

    <!-- Resumen de la inscripción -->
    <section class="insc-manage-summary">
      <div class="insc-summary-row">
        <span class="insc-summary-label">Archivo:</span>
        {# deja aquí el mismo link que ya tenías para ver el archivo #}
        <span class="insc-summary-value">
          <a href="{{ object.file.url }}" target="_blank" rel="noopener">
            Ver archivo
          </a>
        </span>
      </div>

      <div class="insc-summary-row">
        <span class="insc-summary-label">Enviado por:</span>
        <span class="insc-summary-value">
          {{ object.full_name }} ({{ object.email }})
          · Dirección: {{ object.address }}
          · Creado: {{ object.created_at|date:"d/m/Y H:i" }}
        </span>
      </div>

      <div class="insc-summary-row">
        <span class="insc-summary-label">Rol solicitado:</span>
        <span class="insc-summary-value">
          {{ object.requested_role_display }}
        </span>
      </div>
    </section>

    <hr class="insc-manage-divider">

    <!-- Formulario de gestión -->
    <form method="post" class="insc-manage-form">
      {% csrf_token %}
      {{ form.non_field_errors }}

      <div class="insc-manage-grid">
        {{ form.as_p }}
      </div>

      <div class="insc-manage-actions">
        <button type="submit" class="btn btn-primary">
          Guardar cambios
        </button>
        <a href="{% url 'core:insc_admin' %}" class="btn btn-outline">
          Volver
        </a>
      </div>
    </form>

    {% if object.last_validated_at %}
      <p class="insc-manage-footer">
        Última validación:
        {{ object.last_validated_at|date:"d/m/Y H:i" }}
        por {{ object.last_validated_by }}
      </p>
    {% endif %}
  </div>
</section>
{% endblock %}
