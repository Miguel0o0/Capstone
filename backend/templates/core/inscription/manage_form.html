{% extends "base.html" %}

{% block title %}Gestionar inscripción #{{ object.id }}{% endblock %}

{% block content %}
<div class="container">
  <h1>Gestionar inscripción #{{ object.id }}</h1>

  <p>
    <strong>Archivo:</strong>
    <a href="{{ object.file.url }}" target="_blank" rel="noopener">Ver archivo</a>
  </p>

  <p class="text-muted">
    Enviado por: {{ object.full_name }}
    {% if object.email %} ({{ object.email }}){% endif %}
    {% if object.address %} • Dirección: {{ object.address }}{% endif %}
    • Creado: {{ object.created_at|date:"d/m/Y H:i" }}
  </p>

  {% if object.desired_role %}
    <p class="text-muted">
      Rol solicitado: {{ object.get_desired_role_display }}
    </p>
  {% endif %}

  <form method="post" class="mt-3">
    {% csrf_token %}
    {{ form.non_field_errors }}

    <div class="mb-3">
      <label class="form-label">Estado</label>
      {{ form.status }}
      {% if form.status.errors %}
        <div class="text-danger small">
          {{ form.status.errors|striptags }}
        </div>
      {% endif %}
    </div>

    <div class="mb-3">
      <label class="form-label">Rol</label>
      {{ form.role }}
      {% if form.role.errors %}
        <div class="text-danger small">
          {{ form.role.errors|striptags }}
        </div>
      {% endif %}
    </div>

    <div class="mb-3">
      <label class="form-label">Nota (opcional)</label>
      {{ form.note }}
      {% if form.note.errors %}
        <div class="text-danger small">
          {{ form.note.errors|striptags }}
        </div>
      {% endif %}
    </div>

    <div class="d-flex gap-2">
      <button type="submit" class="btn btn-primary">Guardar</button>
      <a class="btn btn-secondary" href="{% url 'core:insc_admin' %}">Volver</a>
    </div>
  </form>

  {% if object.validated_at %}
    <hr>
    <p class="text-muted">
      Última validación: {{ object.validated_at|date:"d/m/Y H:i" }}
      por {{ object.validated_by|default:"—" }}
    </p>
  {% endif %}
</div>
{% endblock %}
